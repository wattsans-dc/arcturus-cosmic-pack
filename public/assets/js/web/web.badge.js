function WebPageBadgeInterface(){this.init=function(){const r={width:"20",height:"20",pixels:[["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0))","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 255, 255)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 255, 255)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(255, 87, 33)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(255, 200, 144)","rgb(255, 200, 144)","rgb(0, 0, 0)","rgb(255, 200, 144)","rgb(255, 200, 144)","rgb(0, 0, 0)","rgb(255, 200, 144)","rgb(255, 200, 144)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 200, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(0, 0, 0)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(0, 0, 0)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 200, 144)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(255, 224, 144)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0, 0, 0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"],["rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)","rgb(0,0,0,0)"]]};$(document).ready(function(){var g=$("#pixelCanvas"),b=!1,e=!1,t=$(".palette"),n=$("#colorPicker"),o=($("#colorPickerSubmit"),null),a=40,i=40,c=function(){$("#resetField").click(function(){g.find("tr").remove(),$(".preview").empty(),c()}),g.find("tr").remove();for(var r=a,b=i,e=1;e<=r;e++){for(var t=document.createElement("tr"),n=1;n<=b;n++)$(t).append('<td class="pixel"></td>');g.append(t)}};$("#downloadImage").click(function(){l()});const l=r=>{var b=document.createElement("a");document.body.appendChild(b),b.style="display: none";g.height(),g.width();var e='<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><foreignObject width="40" height="40"><div xmlns="http://www.w3.org/1999/xhtml" width="40" height="40"><table style="border-spacing: 0; border-collapse: collapse; width:40px;height:40px">'+g.clone().html()+"</table></div></foreignObject></svg>",t=window.URL||window.webkitURL||window,n=(new Image,new Blob([e],{type:"image/svg+xml"}));t.createObjectURL(n);$(".preview").html(e),$("#buybadge").unbind().click(function(){s()})};var d=function(r){if(e)$(r).css("background-color","rgb(0,0,0,0)");else{var g=o.css("background-color");$(r).css("background-color",g)}l()},s=function(r){function g(r,g){return(g||document.body).querySelector(r)}const b=g(".preview svg"),e=g("#img img"),t=g("#canvas canvas"),n=(new XMLSerializer).serializeToString(b),o="data:image/svg+xml;base64,"+btoa(n);e.onload=function(){t.width=e.naturalWidth||e.width,t.height=e.naturalHeight||e.height,t.toDataURL("image/gif"),t.getContext("2d").drawImage(e,0,0);var r=t.toDataURL("image/gif").replace("data:image/png;","data:image/gif;");var csrftoken = $('[name=csrftoken]').val();console.log(csrftoken);Web.ajax_manager.post("/shop/drawbadge/validate",{blob:r,csrftoken:csrftoken})},e.setAttribute("src",o)};var u,p=function(r){e=r.shiftKey},h=function(r){o=r,$(".palette-color").removeClass("palette-color-selected"),o.addClass("palette-color-selected")};c(),i=(u=r).width,a=u.height,c(),jQuery.each(g.find("tr"),function(r,g){jQuery.each($(g).find("td"),function(g,b){$(b).css("background-color",u.pixels[r][g])})}),l(),h($(".palette-color").first()),g.on("mousedown",".pixel",function(r){d(r.target),b=!0}),$(document).on("mouseup",function(){b=!1}),$(document).keydown(p),$(document).keyup(p),g.on("mouseenter",".pixel",function(r){b&&d(r.target)}),$(".palette").on("click",".palette-color",function(r){h($(r.target))}),$("#colorPickerSubmit").click(function(){var r=$('<div class="palette-color"></div>').css("background-color",n.val());t.append(" "),t.append(r)}),$("#gridToggle").change(function(r){r.target.checked?g.removeClass("pixel-canvas-nogrid"):g.addClass("pixel-canvas-nogrid")})})}}